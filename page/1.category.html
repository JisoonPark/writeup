---
layout: default
title: Categories
permalink: /category/
type: page
---

<style type="test/css">
table {
   border:0px;
   background-color:white;
}
</style>

<div class="page clearfix">
  <div class="left">
    <h1>{{page.title}}</h1>
    <hr>

    <table width="90%">
      <tr>
        <td width="40%" valign="top">
      <h2>Input</h2>
      <!-- <form> -->
        <div class="form-group">
          <label for="input-search" class="sr-only">Search Tree:</label>
          <input type="input" class="form-control" id="input-search" placeholder="Type to search..." value="">
        </div>
        <div class="checkbox">
          <label>
            <input type="checkbox" class="checkbox" id="chk-ignore-case" value="false">
            Ignore Case
          </label>
        </div>
        <div class="checkbox">
          <label>
            <input type="checkbox" class="checkbox" id="chk-exact-match" value="false">
            Exact Match
          </label>
        </div>
        <div class="checkbox">
          <label>
            <input type="checkbox" class="checkbox" id="chk-reveal-results" value="false">
            Reveal Results
          </label>
        </div>
        <button type="button" class="btn btn-success" id="btn-search">Search</button>
        <button type="button" class="btn btn-default" id="btn-clear-search">Clear</button>
      <!-- </form> -->
  </td>
  <td width="50%" valign="top">
      <h2>Results</h2>
      <div id="search-output"></div>
  </td>
</tr>
</table>
    <div class="col-sm-12">
      <h2>Posts</h2>
      <div id="treeview-searchable" class=""></div>
    </div>
  </div>
</div>

<script>
  var tree = [
    {% for category in site.categories %}{
      text: "{{category | first}}",
      selectable: false,
      state: {
        checked: false,
        disabled: false,
        expanded: false,
        selected: false
      },
      nodes: [
        {% for posts in category %}
          {% for post in posts %}
            {% if post.url %}
            {
              text: "<time>{{ post.date | date:"%F" }} {{ post.date | date: "%a" }}.</time>&nbsp;&nbsp;{{ post.title }}",
              href: "{{ post.url | prepend: site.url }}",
              icon: "glyphicon glyphicon-stop",
              selectedIcon: "glyphicon glyphicon-stop",
              selectable: true,
            },
            {% endif %}
          {% endfor %}
        {% endfor %}
      ]
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]

  var $searchableTree = $('#treeview-searchable').treeview({
    data: tree,
    showBorder: false,
    enableLinks: true
  });

  var search = function(e) {
    var pattern = $('#input-search').val();
    var options = {
      ignoreCase: $('#chk-ignore-case').is(':checked'),
      exactMatch: $('#chk-exact-match').is(':checked'),
      revealResults: $('#chk-reveal-results').is(':checked')
    };
    var results = $searchableTree.treeview('search', [ pattern, options ]);

    var output = '<p>' + results.length + ' matches found</p>';
    $.each(results, function (index, result) {
      if (typeof myVar !== 'undefined')
        output += '<p>- <a href="' + result.href + '">' + result.text + '</a></p>';
    });
    $('#search-output').html(output);
  }

  $('#btn-search').on('click', search);
  $('#input-search').on('keyup', search);

  $('#btn-clear-search').on('click', function (e) {
    $searchableTree.treeview('clearSearch');
    $('#input-search').val('');
    $('#search-output').html('');
  });

  if (window.location.hash.length > 2) {
    var $cat = window.location.hash.slice(1);
  }

  var catNode = $searchableTree.treeview('search', [ $cat, {
    ignoreCase: false,     // case insensitive
    exactMatch: true,    // like or equals
    revealResults: false,  // reveal matching nodes
  }]);

  $.each(catNode, function (index, node) {
    $searchableTree.treeview('expandNode', [ node, { levels: 2, silent: true } ]);
  });
</script>
